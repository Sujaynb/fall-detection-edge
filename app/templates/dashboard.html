<!doctype html>
<html>
<head>
  <meta charset="utf-8"><title>Fall Logs</title>
  <style>table, th, td{border:1px solid #444;border-collapse:collapse;padding:6px;}</style>
</head>
<body>
  <h2>Recent Falls</h2>
  <table>
    <thead><tr><th>Time</th><th>IP</th><th>Location</th><th>Confidence</th><th>Image</th></tr></thead>
    <tbody id="log-table"></tbody>
  </table>
  <script>
    fetch("/api/falls/recent").then(r=>r.json()).then(rows=>{
      const t=document.getElementById("log-table");
      rows.forEach(r=>{
        const tr=document.createElement("tr");
        const filename = r.image_path ? r.image_path.split('/').pop() : '';
        tr.innerHTML = `<td>${r.timestamp}</td><td>${r.ip}</td><td>${r.location}</td><td>${r.confidence}</td>
                        <td>${filename ? `<a href="/falls/${filename}" target="_blank">View</a>` : '' }</td>`;
        t.appendChild(tr);
      });
    });
  </script>
  <p><a href="{{ url_for('home') }}">Back</a></p>
</body>
</html>
